(function(){window.User_Subcribe={data:{tabIndex:0,loading:false,ready:false,autoList:[],month:0,monthText:"",hasGet:false},watch:{topdataloading:"initData"},methods:{initData:function(){if(!this.hasGet&&this.topdataloading[5]){this.hasGet=true;this.getMySubcribeInfo()}},getMySubcribeInfo:function(){var t=this;ajaxService("/partview/GetMySubcribeInfo",{},function(e,i){t.ready=true;if(i==1){Util.showMsgBox("网络连接异常，请稍后再试",1e3);return}if(i==2){Util.showMsgBox("系统错误，请稍后再试",1e3);return}if(e!=""){if(e.MonthTime==""){t.monthText="您尚未订购包月"}else{t.monthText="您当前包月到期时间："+e.MonthTime}if(e.List.length>0)t.autoList=e.List}})},delBook:function(t,e){if(this.loading)return;var i=this;i.loading=true;ajaxService("/Service/DeleteAutoVip",{bookid:e},function(e,o){i.loading=false;if(o==1){Util.showMsgBox("网络连接异常，请稍后再试",1e3);return}if(o==2){Util.showMsgBox("系统错误，请稍后再试",1e3);return}if(e.Code==0){Util.showMsgBox("删除成功",1e3);i.autoList.splice(t,1)}else{if(e.Code==99){location.href="/UserValidator";return}Util.showMsgBox("删除失败",1e3)}})},buyMonth:function(){if(this.loading)return;if(this.month<=0){Util.showMsgBox("请选择包月数量",1e3);return}var t=this.getNeedCoin(this.month);if(this.topaccountinfo.account<=t){Util.showMsgBox("余额不足",1e3);return}var e=this;e.loading=true;ajaxService("/Service/BuyMonth",{month:this.month},function(i,o){e.loading=false;if(o==1){Util.showMsgBox("网络连接异常，请稍后再试",1e3);return}if(o==2){Util.showMsgBox("系统错误，请稍后再试",1e3);return}if(i.Code==0){var n="包月成功";if(i.Data.Mons>0)n+="，获得月票"+i.Data.Mons+"张";if(i.Data.Assess>0)n+="，获得评价票1张";Util.showMsgBox(n,1e3);e.monthText="您当前包月到期时间："+i.MonthTime;e.topaccountinfo.account-=t;e.topuserinfo.vip=true}else{if(i.Code==99){location.href="/UserValidator";return}Util.showMsgBox(i.Message,1e3)}})},getNeedCoin:function(t){var e=0;switch(t){case 1:e=1500;break;case 3:e=4e3;break;case 6:e=7e3;break;case 12:e=12e3;break;case 24:e=2e4;break}return e}}}})();