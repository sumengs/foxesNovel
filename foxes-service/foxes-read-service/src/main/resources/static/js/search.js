(function(){var s=false;var a=$(".choosed-classify .tags");var i=1;var t=1;var e=0;window.Init=function(a,i,n){s=a;t=i;e=n;l();window.loginCallBack=function(){location.reload()};$("#hform").attr("target","_self")};window.addShelft=function(a){if(!s){window.login();return}var i=$("#addShelfBtn"+a);if(i.hasClass("keep-btn"))return;menuBookCase.addBookCase(a,function(){i.addClass("keep-btn").html("已在书架")})};window.buySpecial=function(a){if(!s){window.login();return}var i=$("#buySpecialBtn"+a);if(i.hasClass("keep-btn"))return;JQBox.FrameBox({title:"订阅特价书",uri:"/payments?q=specialbook&bookid="+a+"&rnd="+Math.random(),width:510,height:450})};$(".book-classify .more").click(function(){var s=$(this).parents("li").height();if(s<=30){$(this).parents("li").css({height:"auto"});$(this).html('收起<i class="iconfont">&#xe7cd;</i>')}else{$(this).parents("li").css({height:"30px"});$(this).html('更多<i class="iconfont">&#xe601;</i>')}return false});var n=$(".classify-list li:gt(4)");var o=$(".classify-show");o.click(function(){if(n.is(":visible")){n.hide();$(this).html('展开<i class="iconfont">&#xe601;</i>')}else{n.show();$(this).html('收起<i class="iconfont">&#xe7cd;</i>')}return false});$(".book-classify li .tags span").click(function(){if(!$(this).hasClass("active")){var s=$(this).text();var i=$(this).parents("li").index();$(this).addClass("active").siblings().removeClass("active");$(".choosed-classify").show();var t=a.find("span.sp"+i);if($(this).index()==0){$(this).parents("li").removeClass("choosen");t.remove();l()}else{var e=$(this).attr("data-value");if(!$(this).parents("li").hasClass("choosen")){var n=$(this).attr("data-type");a.append('<span class="sp'+i+'" data-type="'+n+'" data-value="'+e+'">'+s+'<i class="iconfont">&#xe622;</i></span>')}else{t.attr("data-value",e);t.html(s+'<i class="iconfont">&#xe622;</i>')}$(this).parents("li").addClass("choosen")}c()}});$(".choosed-classify span .iconfont").live("click",function(){var s=$(this).parents("span").attr("class").split("sp")[1];if(s==99){$("#searchkeyword").val("");$(this).parents("span").remove()}else{$(".book-classify li").eq(s).removeClass("choosen");$(".book-classify li").eq(s).find("span").removeClass("active");$(".book-classify li").eq(s).find(".tags span:first-child").addClass("active")}$(this).parents("span").remove();l();c()});$(".result-sort a").click(function(){$(this).addClass("active").siblings().removeClass("active");c()});$("#gopage").click(function(){var s=parseInt($("#pageindex").val());if(isNaN(s)||s<1||s>e||s==t)return;$("#pageindex").val(s);setPage(s)});function l(){if(a.find("span").length==0){$(".choosed-classify").hide()}else{$(".choosed-classify").show()}}window.setPage=function(s){i=s;c()};function c(){var s="/search?";a.find("span").each(function(){var a=$(this).attr("data-type");var i=$(this).attr("data-value");s+="&"+a+"="+i});s+="&sort="+$(".result-sort .active").attr("data-value");s+="&pn="+i;location.href=s}})();